<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Leonel Herrera-Alsina" />

<meta name="date" content="2023-01-24" />

<title>Using LEMAD</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using LEMAD</h1>
<h4 class="author">Leonel Herrera-Alsina</h4>
<h4 class="date">2023-01-24</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Our Lineage Extinction Model of Ancestral Distribution (LEMAD)
computes the likelihood of the modern distribution of species (given the
parameters of the model) where lineage extinction is a fundamental part
of the calculation. LEMAD generalizes the likelihood described in GeoSSE
for any number of areas and under several sets of geographic assumptions
that facilitate its use in Ancestral Distribution Estimation (ADE). In
LEMAD, the species’ geographic distribution changes over time in a
similar manner as an evolving discrete trait does in SSE models.
Lineages expand and contract their geographic distribution by colonising
new regions and going locally extinct from others; these processes take
place along the branches of the phylogenetic tree. LEMAD assumes that
rates of speciation and extinction are constant across regions. DIVA and
DEC are popular methods for ADE and they differ in the set of geographic
assumptions (see below); in a LEMAD framework, we can use both DIVA and
DEC sets of assumptions (we call them DIVAevents and DECevents).
DIVAevents assumes that widespread species can split their ranges
(vicariance) in any combination regardless the number of areas where
daughter lineages inhabit (e.g., a species presents in region A, B, C
and D can split in AB-CD or A-BCD; widespread vicariance sensu Matzke
2013) while DECevents assumes that one of the daughter lineages will be
present at a single region (e.g., ABCD species splits in A-BCD or B-ACD;
narrow vicariance). For in-situ speciation and in contrast with
DIVAevents, DECevents allows that widespread species have a given
population diverging from the rest, becoming a different species which
coexists with the parental lineage e.g., ABCD species produces ABCD and
the new species is restricted to A (in-situ subset hereafter; sympatry
subset sensu Matzke 2013).</p>
<p>It could be convenient to remove all the objects in memory and then
load LEMAD:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DDD)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lemad)</span></code></pre></div>
<p>Similar to the DIVA, DEC, BioGeoBears,LEMAD uses two input files: 1)
a rooted, ultrametric tree in nexus format (for conversion of other
formats to nexus, we refer to the documentation in package ‘ape’) and 2)
a data file with geographic information. This file will have two
columns, the first containing taxa names (which should match the names
in the phylogeny) and the second a code for the region where each
species inhabits (usually A,B,C, etc., but notice that ‘NA’ is a valid
code too, if you are not sure about the distribution of that species). A
comma-separated value file (.csv) generated in MsExcel works
particularly well. The *.csv file can be loaded into R using the
read.csv() function. In this vignette, we are loading R objects (using
the function data()) instead of nexus trees or csv files as it was
better to handle when building this vignette document. But, we provide a
line commented out on how to the file uploading should be done:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># amazilia_distribution &lt;- read.csv(file=&quot;humm_distribution.csv&quot;)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(distributioninfo)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(amazilia_distribution)</span></code></pre></div>
<pre><code>##                 species region
## 1     Amazilia_amabilis     AB
## 2     Amazilia_amazilia      A
## 3   Amazilia_berryllina     BC
## 4      Amazilia_candida     BC
## 5 Amazilia_chionogaster      A
## 6 Amazilia_chionopectus      A</code></pre>
<p>In this data set (here we see only the top lines of the data frame),
hummingbird species can live in regions A, B or C or any combination of
them. Note that first species is a multi-region one, and the proper way
to indicate it is with “AB”.</p>
<p>The second object we need is an ultrametric phylogenetic tree, that
is rooted and has labeled tips. One can load it in R by using
read.nexus(). In our example we load a prepared phylogeny named
“phylo_Vign”:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># amazilia_tree &lt;- read.nexus(&quot;amazilia_phylo.nex&quot;) # example of how to load a tree</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;phylo_Vign2&quot;</span>)</span></code></pre></div>
<p>To run LEMAD it is important that tree tip labels agree with taxon
names in the distribution file, but also that these are in the same
order. To that end, we run the following piece of code prior to any
analysis:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(amazilia_distribution) <span class="ot">&lt;-</span> amazilia_distribution<span class="sc">$</span>species</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>geiger<span class="sc">:::</span><span class="fu">name.check</span>(amazilia_tree, amazilia_distribution, <span class="at">data.names=</span><span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## [1] &quot;OK&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>amazilia_distribution<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="fu">toupper</span>(amazilia_distribution<span class="sc">$</span>region)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>amazilia_distribution <span class="ot">&lt;-</span> amazilia_distribution[<span class="fu">order</span>(<span class="fu">match</span>(amazilia_distribution<span class="sc">$</span>species,amazilia_tree<span class="sc">$</span>tip.label)),]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>(amazilia_distribution<span class="sc">$</span>species) <span class="sc">==</span> (amazilia_tree<span class="sc">$</span>tip.label)</span></code></pre></div>
<pre><code>##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [31] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [46] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [61] TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
<p>The last line should produce a vector of only TRUE which confirms our
phylogenic tree and species distribution object match each other. Now
that our phylogenetic tree and species distribution are working fine, we
declare these variables for simplicity:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>phylotree_recons <span class="ot">&lt;-</span> amazilia_tree</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>species_presence <span class="ot">&lt;-</span> amazilia_distribution<span class="sc">$</span>region</span></code></pre></div>
<p>If the letters that are coding the distribution of species is
unsorted (e.g., BAC instead of ABC), we can run the following lines to
solve it.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for(ik in 1:length(species_presence)){</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  string_to_sort &lt;- species_presence[ik]</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  species_presence[ik] &lt;- paste(sort(unlist(strsplit(string_to_sort, &quot;&quot;))), collapse = &quot;&quot;)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span></code></pre></div>
<p>We need to specify that our analysis will have three region. We do
not have to specify all the multi-region combinations.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>all_areas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>)</span></code></pre></div>
<p>Many datasets are not perfect and we have to learn to live with that.
Because LEMAD considers the lineages that went extinct (i.e., missing
branches) into the analysis, if our phylogenetic tree is incomplete
because of sampling issues, the estimation of extinction can be off.
Although LEMAD would not distinguish between missing branches due to
extinction and missing branches due to sampling (e.g., it was not
possible to obtain molecular information for all the extant species), we
can help the analysis by specifying we are aware of sampling issues in
our tree. In this example, our tree includes 80% of all the species
living in region A, the 57% of species living in B and 83% of the
species living in both. All species living region C are present in the
tree, also all the species living in AC or BC, etc. We set the following
list to set the regions that are incomplete (regions whose inhabitants
are all present in the tree, do not have to be specified)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>missing_spp_areas <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>missing_spp_areas[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;AB&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>missing_spp_areas[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.57</span>,<span class="fl">0.83</span>)</span></code></pre></div>
<p>Notice that the order of the second list object should match that of
the first list object. We need to set what is the maximum number of
areas where a species can take at a given point in time. This means, the
most widespread ancestor, could it be spread in A, B and C? or we limit
that lineages can only live in two regions? In the case of this group of
hummingbirds, there are few species that are indeed, present at the
three regions at the present. So, it might be safe to assume that
ancestors could achieve the same. In datasets with more regions, one
should make a decision whether a species can be truly “cosmopolitan” or
not.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>num_max_multiregion <span class="ot">&lt;-</span> <span class="dv">3</span></span></code></pre></div>
<p>By doing that line, we are saying that lineages can be present in:
“A” “B” “C” “AB” “AC” “BC” “ABC” Now, let’s imagine that we have four
regions (A,B,C,D) and we still think that the maximum number of regions
a species can simultaneously be present at is 3. This makes that all the
possible distributions are: “A” “B” “C” “D” “AB” “AC” “AD” “BC” “BD”
“CD” “ABC” “ABD” “ACD” “BCD” “ABCD”</p>
<p>Imagine we have regions A,B,C,D and E, setting the maximum number of
regions to occur at the same time has a major consequence in the total
number of potential distributions: when num_max_multiregion = 2, we get
15 different distributions when num_max_multiregion = 3, we get 25
different distributions when num_max_multiregion = 4, we get 30
different distributions</p>
<p>The higher the number of potential distributions, the more equations
have to be solved and the slower the analysis is. We cannot set
num_max_multiregion to 1 because we need some (at least) two-region
species because the model assumes there are vicariance events. LEMAD
also offers the option to account for an region that it was part of the
past distribution of a clade but it is not at the present time. Imagine
Antarctica for instance which might have been key for the
diversification process of a clade/radiation but at some point stopped
being inhabited by species. This means that our clade is distributed in
regions A, B and C but region D (currently empty, no modern species
lives in D) might have been important. Notice that we are taking the
model at very limit because there is no tree tip that contributes to the
calculation of probabilities of ancestors living in region D. To run
this analysis, we use the same dataset, the only thing that changes is
the argument num_max_multiregion. For the analysis that includes an area
with no modern species, we do: num_max_multiregion &lt;- c(3,“D”).
Similar to what we set up before, we are saying that the maximum number
of regions that an ancestor can take is 3. And that, besides the regions
A,B and C that we define in all_areas, we have region “D” too.</p>
<p>In LEMAD we can fit models where the extinction rate is fixed to a
certain figure. This means that the provided rate will be plugged into
the analysis. At the end, we will get a likelihood value for such a
model. When fixing the model to a different extinction rate, the
likelihood could be different. By comparing both results, we will know
which model is supported better. Also, we can let the extinction rate be
estimated during the calculation. To do that we use the argument:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lineage_extinction &lt;- &quot;free&quot;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>lineage_extinction <span class="ot">&lt;-</span> <span class="fl">0.001</span></span></code></pre></div>
<p>Before starting the optimization (Maximum likelihood search, which
will find the combinations of rates that fit best), we can provide of
“initial values”. The search algorithm needs to start calculating the
very first likelihood using a set of rates. From there, it will try
rates that are slightly lower or higher, calculate the likelihood and
check whether those likelihoods are better than the resulting one from
the previous parameter combination. This makes the algorithm decide
which direction to take.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>initial_lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>initial_disperextirpation <span class="ot">&lt;-</span> <span class="fl">0.002</span></span></code></pre></div>
<p>Those lines are saying that we want to start the ML search where
speciation is 0.01 and the rate of colonizing and disappearing from
regions is 0.002. Note that the initial lambda is a vector of length 2
because we have two types of speciation: in-situ and vicariance. We need
to provide a value for each type of speciation. If we do not have a
better initial guess, we do both 0.01. Again, these are only starting
points. If we have no clue what a sensible starting point would be, we
set both arguments to NULL and LEMAD will provide a standard starting
point (the lambda will come from fitting a birth-death model to the
phylogenetic tree). In principle, it does not matter where we start the
search, it should always converge to the same value. LEMAD allows
fitting models under the assumptions of DIVAevents or DECevets (see
Introduction). Because they are different parameterizations of the same
model, the comparison of their likelihoods is valid and straightforward
so data will inform which set of assumptions is more likely. We need to
use the variable:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>DEC_events <span class="ot">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># to choose DIVAevents</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or when choosing DECevents:</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># DEC_events &lt;- TRUE </span></span></code></pre></div>
<p>There are cases where the user wishes to define his/her own matrix of
dispersal and extirpation events. If you do not need this, please skip
this part and jumo to “Finally, we can incorporate information …..”. Let
us first see what the default matrix is like, we do that with the
following lines:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>object_a <span class="ot">&lt;-</span> <span class="fu">prepare_full_lambdas_vicariance</span>(all_areas,num_max_multiregion,<span class="dv">1</span>,<span class="dv">2</span>,DEC_events)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>my_dispersal_extirpationMatrix <span class="ot">&lt;-</span> <span class="fu">lemad_prepare_q_matrix</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  object_a<span class="sc">$</span>all_area_combination,object_a<span class="sc">$</span>matrices_names,<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>my_dispersal_extirpationMatrix</span></code></pre></div>
<pre><code>##      A  B  C AB AC BC ABC
## A   NA  0  0  4  4  0   0
## B    0 NA  0  4  0  4   0
## C    0  0 NA  0  4  4   0
## AB   4  4  0 NA  0  0   4
## AC   4  0  4  0 NA  0   4
## BC   0  4  4  0  0 NA   4
## ABC  0  0  0  4  4  4  NA</code></pre>
<p>If you are setting up an analysis that includes “a region with no
modern species in”, you might need to use</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prepare_full_lambdas_vicariance</span>(<span class="fu">c</span>(all_areas,<span class="st">&quot;D&quot;</span>),num_max_multiregion,<span class="dv">1</span>,<span class="dv">2</span>,DEC_events)</span></code></pre></div>
<pre><code>## $all_matrices
## $all_matrices$A
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   1 0 0 0  0  0  0  0  0  0   0   0   0   0
## B   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## C   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$B
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## B   0 1 0 0  0  0  0  0  0  0   0   0   0   0
## C   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$C
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## B   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## C   0 0 1 0  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$D
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## B   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## C   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 1  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$AB
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 2 0 0  0  0  0  0  0  0   0   0   0   0
## B   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## C   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$AC
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 2 0  0  0  0  0  0  0   0   0   0   0
## B   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## C   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$AD
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 2  0  0  0  0  0  0   0   0   0   0
## B   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## C   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$BC
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## B   0 0 2 0  0  0  0  0  0  0   0   0   0   0
## C   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$BD
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## B   0 0 0 2  0  0  0  0  0  0   0   0   0   0
## C   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$CD
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## B   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## C   0 0 0 2  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$ABC
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 0  0  0  0  2  0  0   0   0   0   0
## B   0 0 0 0  0  2  0  0  0  0   0   0   0   0
## C   0 0 0 0  2  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$ABD
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 0  0  0  0  0  2  0   0   0   0   0
## B   0 0 0 0  0  0  2  0  0  0   0   0   0   0
## C   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## D   0 0 0 0  2  0  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$ACD
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 0  0  0  0  0  0  2   0   0   0   0
## B   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## C   0 0 0 0  0  0  2  0  0  0   0   0   0   0
## D   0 0 0 0  0  2  0  0  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## $all_matrices$BCD
##     A B C D AB AC AD BC BD CD ABC ABD ACD BCD
## A   0 0 0 0  0  0  0  0  0  0   0   0   0   0
## B   0 0 0 0  0  0  0  0  0  2   0   0   0   0
## C   0 0 0 0  0  0  0  0  2  0   0   0   0   0
## D   0 0 0 0  0  0  0  2  0  0   0   0   0   0
## AB  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## AD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BC  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## CD  0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABC 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ABD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## ACD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## BCD 0 0 0 0  0  0  0  0  0  0   0   0   0   0
## 
## 
## $matrices_names
##  [1] &quot;A&quot;   &quot;B&quot;   &quot;C&quot;   &quot;D&quot;   &quot;AB&quot;  &quot;AC&quot;  &quot;AD&quot;  &quot;BC&quot;  &quot;BD&quot;  &quot;CD&quot;  &quot;ABC&quot; &quot;ABD&quot;
## [13] &quot;ACD&quot; &quot;BCD&quot;
## 
## $all_area_combination
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
## [1,] &quot;A&quot;  &quot;B&quot;  &quot;C&quot;  &quot;D&quot;  &quot;A&quot;  &quot;A&quot;  &quot;A&quot;  &quot;B&quot;  &quot;B&quot;  &quot;C&quot;   &quot;A&quot;   &quot;A&quot;   &quot;A&quot;   &quot;B&quot;  
## [2,] NA   NA   NA   NA   &quot;B&quot;  &quot;C&quot;  &quot;D&quot;  &quot;C&quot;  &quot;D&quot;  &quot;D&quot;   &quot;B&quot;   &quot;B&quot;   &quot;C&quot;   &quot;C&quot;  
## [3,] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA    &quot;C&quot;   &quot;D&quot;   &quot;D&quot;   &quot;D&quot;  
## [4,] NA   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA</code></pre>
<p>so the area “D” is included too.<br />
Now, we can call my_dispersal_extirpationMatrix and edit as we wish.
Notice that we use the number 4 to indicate what movements/transitions
are possible and 0 for those that are not. To edit, you could do:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># my_dispersal_extirpationMatrix[1,4] &lt;- 0</span></span></code></pre></div>
<p>Remember that the main diagonal should keep NAs. Please make sure
that after editing, the following expression
class(my_dispersal_extirpationMatrix) retrieves “matrix” “array”. The
last step is to do:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>initial_disperextirpation <span class="ot">&lt;-</span> my_dispersal_extirpationMatrix</span></code></pre></div>
<p>In summary, initial_disperextirpation can 1) be NULL (lemad will take
1/5 of initial lambda to start the optimization), 2) be a number
provided by the user (lemad will start the optimization from this value)
or 3) be a dispersal/extirpation matrix defined by the user (in that
case the optimization will start in a value 1/5 lambda).</p>
<p>Finally, we can incorporate information on the distribution of the
common ancestor of the whole clade. So, LEMAD will compute the
likelihood conditioned on the information we provided. To indicate that
the very first ancestor of the clade was present in area A, We do:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># condition_on_origin &lt;- A</span></span></code></pre></div>
<p>Generally, we lack this information so we normally want LEMAD not to
condition on a particular area. We do:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>condition_on_origin <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>To launch the analysis:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>output_vig <span class="ot">&lt;-</span> <span class="fu">lemad_analysis</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a> phylotree_recons,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a> species_presence,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a> <span class="at">areas =</span> all_areas,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a> num_max_multiregion,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a> condition_on_origin,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a> DEC_events,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a> <span class="at">missing_spp_areas =</span> missing_spp_areas,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a> <span class="at">lineage_extinction =</span> lineage_extinction,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a> <span class="at">initial_lambda =</span> initial_lambda,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a> <span class="at">initial_disperextirpation =</span> initial_disperextirpation)</span></code></pre></div>
<pre><code>## You are optimizing lambda0 mu0 
## You are fixing lambda1 mu1 
## Optimizing the likelihood - this may take a while. 
## The loglikelihood for the initial parameter values is -194.187109987583.
## 
## Maximum likelihood parameter estimates: lambda0: 0.154894, mu0: 0.000053, lambda1: 0.000000, mu1: 0.000000: 
## Maximum loglikelihood: -182.993983
## I am checking your input right now 
## You set some transitions as impossible to happen 
## Calculating the likelihood for the initial parameters. 
## 0.01 0.01 1.05273e-05 -799.484 
## The loglikelihood for the initial parameter values is -799.484 
## Optimizing the likelihood - this may take a while. 
##  
## 0.01 0.01 1.05273e-05 -799.484 
## 0.0105 0.01 1.05273e-05 -797.1073 
## 0.01 0.0105 1.05273e-05 -798.9258 
## 0.01 0.01 1.105367e-05 -797.1425 
## 1 0.01 0.01 1.05273020218909e-05 -799.484033675649 initial 
## 0.01033328 0.01033328 1.087821e-05 -795.9376 
## 0.0105 0.0105 1.105367e-05 -794.2081 
## 2 0.0105 0.0105 1.10536671229854e-05 -794.208116580724 expand 
## 0.01066678 0.009833443 1.122912e-05 -793.436 
## 0.0110005 0.009500495 1.158003e-05 -790.858 
## 3 0.0110004952947004 0.00950049455984174 1.15800327781949e-05 -790.857985776067 expand 
## 0.01133443 0.01 1.105367e-05 -791.051 
## 4 0.0110004952947004 0.00950049455984174 1.15800327781949e-05 -790.857985776067 reflect 
## 0.01139011 0.01 1.193094e-05 -787.1481 
## 0.01183576 0.01 1.263277e-05 -782.5461 
## 5 0.01183575677462 0.01 1.2632765750962e-05 -782.54610566048 expand 
## 0.01228179 0.009167765 1.245731e-05 -782.4272 
## 0.01317505 0.008502964 1.315913e-05 -777.2838 
## 6 0.0131750496360027 0.00850296442687747 1.31591330685214e-05 -777.283795762862 expand 
## 0.0126724 0.008669083 1.386096e-05 -776.4394 
## 0.01334271 0.008004938 1.526461e-05 -770.2565 
## 7 0.0133427105742181 0.00800493827160494 1.52646078799516e-05 -770.256530428951 expand 
## 0.01457392 0.008170892 1.579098e-05 -764.1571 
## 0.01637012 0.007507404 1.789646e-05 -753.6074 
## 8 0.0163701244813279 0.00750740375123396 1.78964638619887e-05 -753.607387863926 expand 
## 0.01676389 0.006017743 1.824738e-05 -754.1754 
## 9 0.0163701244813279 0.00750740375123396 1.78964638619887e-05 -753.607387863926 reflect 
## 0.01781543 0.005852497 2.11132e-05 -744.6362 
## 0.0201516 0.00453248 2.509027e-05 -733.6794 
## 10 0.0201515992892049 0.00453248031496063 2.50902742284305e-05 -733.679439956637 expand 
## 0.02221404 0.004038367 2.555817e-05 -729.6928 
## 0.02670821 0.002066765 3.070503e-05 -720.8373 
## 11 0.0267082099144919 0.00206676485027 3.07050274047582e-05 -720.837291920323 expand 
## 0.02539015 0.003380305 3.088049e-05 -716.6992 
## 0.02975841 0.002066765 3.719716e-05 -706.7936 
## 12 0.0297584080717492 0.00206676485027001 3.71971643615525e-05 -706.793615383555 expand 
## 0.03484368 -0.001690577 4.409881e-05 -Inf 
## 0.0209264 0.005192055 2.444692e-05 -731.5204 
## 13 0.0297584080717492 0.00206676485027001 3.71971643615525e-05 -706.793615383555 contract inside 
## 0.03148011 0.001684297 3.647581e-05 -707.8325 
## 14 0.0297584080717492 0.00206676485027001 3.71971643615525e-05 -706.793615383555 reflect 
## 0.03783607 -0.001292585 4.513861e-05 -Inf 
## 0.02510195 0.003563013 2.961976e-05 -718.5662 
## 15 0.0297584080717492 0.00206676485027001 3.71971643615525e-05 -706.793615383555 contract inside 
## 0.0308463 0.002808249 3.81568e-05 -700.1421 
## 0.03292787 0.003179402 4.188273e-05 -691.264 
## 16 0.032927872020525 0.00317940223524703 4.18827329953765e-05 -691.263968632269 expand 
## 0.03774994 0.00105962 4.741752e-05 -693.2306 
## 17 0.032927872020525 0.00317940223524703 4.18827329953765e-05 -691.263968632269 reflect 
## 0.03546417 0.002518413 4.785583e-05 -684.5544 
## 0.03746776 0.002935992 5.354594e-05 -674.8996 
## 18 0.0374677648082486 0.00293599184733162 5.35459387010436e-05 -674.899590860415 expand 
## 0.0424064 0.002714996 5.80338e-05 -666.8194 
## 0.04884763 0.003039427 6.845245e-05 -651.759 
## 19 0.0488476324062202 0.00303942682771472 6.84524488628458e-05 -651.759045964465 expand 
## 0.04166696 0.005051518 6.183643e-05 -656.8732 
## 20 0.0488476324062202 0.00303942682771472 6.84524488628458e-05 -651.759045964465 reflect 
## 0.05253577 0.00417049 8.067449e-05 -637.128 
## 0.06262155 0.004666768 0.0001000715 -618.8272 
## 21 0.0626215517549193 0.00466676794069405 0.000100071492227612 -618.82722076101 expand 
## 0.06483586 0.005571091 0.0001000282 -615.4746 
## 0.07906861 0.006893841 0.0001232709 -596.2104 
## 22 0.0790686117391814 0.00689384066355693 0.000123270894442673 -596.21035730739 expand 
## 0.08599511 0.004676943 0.000132695 -594.6512 
## 0.1096047 0.00448976 0.000168128 -577.1205 
## 23 0.109604736864085 0.00448975996208993 0.0001681280020389 -577.120490164541 expand 
## 0.1203438 0.0076691 0.0001925339 -562.2392 
## 0.159876 0.01 0.0002545862 -541.2338 
## 24 0.159876041754359 0.0100000000000004 0.000254586190033762 -541.233759553779 expand 
## 0.1732455 0.009590903 0.000263926 -539.2207 
## 0.2376691 0.01207112 0.0003458735 -523.9291 
## 25 0.237669064305407 0.0120711163889677 0.00034587346200743 -523.929085159365 expand 
## 0.2698245 0.01080065 0.0003891457 -521.0385 
## 0.3929457 0.01276545 0.0005221361 -516.8872 
## 26 0.392945687887902 0.0127654452570849 0.000522136089703512 -516.887216713495 expand 
## 0.4475944 0.01883357 0.0005803294 -515.2221 
## 0.7076766 0.0261602 0.0007865576 -536.6317 
## 27 0.447594373090044 0.0188335712598476 0.000580329429283608 -515.222131142436 reflect 
## 0.6243732 0.01913641 0.0007110574 -530.7539 
## 0.4765447 0.01683685 0.0005969005 -518.7105 
## 28 0.447594373090044 0.0188335712598476 0.000580329429283608 -515.222131142436 contract outside 
## 0.7162363 0.02023973 0.0007871325 -539.636 
## 0.3304146 0.01410098 0.0004561517 -515.6808 
## 29 0.447594373090044 0.0188335712598476 0.000580329429283608 -515.222131142436 contract inside 
## 0.3106567 0.01362158 0.0004421844 -515.6791 
## 30 0.447594373090044 0.0188335712598476 0.000580329429283608 -515.222131142436 reflect 
## 0.3291175 0.01827605 0.000463635 -512.3948 
## 0.2993479 0.0210539 0.000434387 -511.6027 
## 31 0.299347900456007 0.0210538995539199 0.000434387001523379 -511.602665812232 expand 
## 0.3687052 0.0215801 0.0005151083 -510.1007 
## 0.3886891 0.02536118 0.0005445891 -508.5002 
## 32 0.388689099845507 0.0253611849753014 0.000544589141249513 -508.500183446762 expand 
## 0.4477966 0.02999434 0.0005973569 -510.4323 
## 33 0.388689099845507 0.0253611849753014 0.000544589141249513 -508.500183446762 reflect 
## 0.3109329 0.03216673 0.0004705561 -505.5625 
## 0.2518423 0.03896504 0.0004156785 -505.9115 
## 34 0.310932916628389 0.0321667304430871 0.000470556088794446 -505.562513416503 reflect 
## 0.4717445 0.03740854 0.0006406303 -509.0974 
## 35 0.310932916628389 0.0321667304430871 0.000470556088794446 -505.562513416503 reflect 
## 0.3317616 0.03325459 0.0005064879 -503.8228 
## 0.2804501 0.03489246 0.0004610595 -503.4811 
## 36 0.280450138773129 0.0348924625532461 0.000461059509688386 -503.481079686856 expand 
## 0.2051137 0.02425771 0.0003435475 -516.9146 
## 0.3946055 0.03408927 0.0005663431 -505.3791 
## 37 0.280450138773129 0.0348924625532461 0.000461059509688386 -503.481079686856 contract inside 
## 0.2704498 0.04220583 0.0004540495 -502.411 
## 0.2185725 0.05083741 0.0004087859 -504.0022 
## 38 0.270449847671715 0.0422058272692842 0.000454049537280959 -502.411022618426 reflect 
## 0.3147245 0.04197908 0.0005170745 -499.8673 
## 0.3166285 0.04695554 0.0005403353 -497.4418 
## 39 0.316628515075576 0.0469555442926908 0.000540335257475236 -497.4418356802 expand 
## 0.198044 0.04866799 0.0004039633 -504.4652 
## 0.2418001 0.04498491 0.0004445533 -501.416 
## 40 0.316628515075576 0.0469555442926908 0.000540335257475236 -497.4418356802 contract outside 
## 0.2706932 0.05471924 0.0004982295 -496.9035 
## 0.2658703 0.06492028 0.0005168156 -494.3992 
## 41 0.265870342637789 0.064920275176141 0.000516815551342258 -494.399244842313 expand 
## 0.2775913 0.06240993 0.0005470875 -492.6072 
## 0.2811922 0.07280862 0.000593613 -488.813 
## 42 0.28119215142624 0.0728086150054981 0.000593613003314735 -488.812970623728 expand 
## 0.3367969 0.07844376 0.0006559762 -489.3732 
## 43 0.28119215142624 0.0728086150054981 0.000593613003314735 -488.812970623728 reflect 
## 0.2719662 0.09833252 0.0006372661 -485.0713 
## 0.2507523 0.1259595 0.0006857386 -481.1227 
## 44 0.250752343091173 0.125959482398753 0.000685738624481318 -481.122731099722 expand 
## 0.3121716 0.120264 0.000773433 -480.4493 
## 0.3366161 0.1501506 0.000901791 -477.7021 
## 45 0.336616104660383 0.150150618762763 0.000901791045830486 -477.702128857453 expand 
## 0.2436629 0.1548923 0.0007980957 -474.9362 
## 0.2017985 0.1973304 0.0008691705 -471.1843 
## 46 0.201798492245724 0.197330433259579 0.000869170521596732 -471.184297386322 expand 
## 0.2407169 0.2556767 0.001044271 -468.1835 
## 0.2214234 0.3726672 0.001269752 -464.2589 
## 47 0.221423388060622 0.37266723416633 0.00126975153338712 -464.258884428552 expand 
## 0.2503303 0.3624545 0.001341552 -463.7525 
## 0.2501194 0.5223284 0.001669782 -461.8502 
## 48 0.250119432729501 0.52232835127571 0.00166978168518996 -461.850159432456 expand 
## 0.1291016 0.6368192 0.001637402 -462.1941 
## 49 0.250119432729501 0.52232835127571 0.00166978168518996 -461.850159432456 reflect 
## 0.194105 1.017346 0.002182915 -461.3075 
## 0.190295 2.067903 0.002841082 -470.4051 
## 50 0.194104967262639 1.01734594648729 0.00218291527346864 -461.307497120526 reflect 
## 0.1583411 1.236245 0.002390817 -460.9624 
## 0.1291819 2.262505 0.002952291 -470.1293 
## 51 0.158341093986841 1.23624500262519 0.00239081679948898 -460.962356211552 reflect 
## 0.2796618 1.195049 0.002525151 -470.4534 
## 0.1633196 0.747951 0.001859191 -459.0902 
## 52 0.16331959891491 0.74795098932367 0.00185919148714362 -459.090201207822 contract inside 
## 0.1025565 1.832088 0.002619188 -471.9874 
## 0.2096456 0.7213467 0.001906965 -459.5182 
## 53 0.16331959891491 0.74795098932367 0.00185919148714362 -459.090201207822 contract inside 
## 0.1597071 0.7509743 0.001921652 -457.6077 
## 0.1432408 0.6425337 0.001791072 -457.3728 
## 54 0.143240785982172 0.642533731221236 0.00179107199904578 -457.372843742429 expand 
## 0.1847888 0.3747756 0.001314576 -460.6696 
## 0.1780643 0.5212871 0.001583419 -458.427 
## 55 0.143240785982172 0.642533731221236 0.00179107199904578 -457.372843742429 contract outside 
## 0.116792 0.5514439 0.001582182 -461.9308 
## 0.1850141 0.6754752 0.001825749 -458.1243 
## 56 0.143240785982172 0.642533731221236 0.00179107199904578 -457.372843742429 contract inside 
## 0.1736953 0.4927578 0.001607644 -456.3768 
## 0.1789529 0.391203 0.001481918 -455.6795 
## 57 0.178952929079215 0.391203007807987 0.00148191797461415 -455.679541062722 expand 
## 0.1596325 0.5983696 0.00181572 -454.8 
## 0.1506312 0.6399163 0.00193191 -453.5294 
## 58 0.150631179496768 0.639916289097201 0.00193191028113803 -453.529350233236 expand 
## 0.1310535 0.4393505 0.00164413 -454.1415 
## 59 0.150631179496768 0.639916289097201 0.00193191028113803 -453.529350233236 reflect 
## 0.1633585 0.3512002 0.001580853 -450.591 
## 0.1736852 0.2411315 0.001475777 -448.1567 
## 60 0.17368521432658 0.241131529671932 0.00147577682261064 -448.156746025481 expand 
## 0.1253476 0.4534069 0.001885971 -448.8268 
## 61 0.17368521432658 0.241131529671932 0.00147577682261064 -448.156746025481 reflect 
## 0.1686589 0.4132205 0.00188492 -445.2933 
## 0.1884151 0.4005081 0.002005359 -442.2723 
## 62 0.188415105897658 0.400508103104002 0.00200535864726249 -442.272269205848 expand 
## 0.1732903 0.1600025 0.001646099 -438.957 
## 0.1849578 0.01193365 0.001503254 -452.855 
## 63 0.173290276323612 0.16000246964068 0.00164609864645933 -438.957037027634 reflect 
## 0.2367497 0.1113151 0.00153215 -441.629 
## 64 0.173290276323612 0.16000246964068 0.00164609864645933 -438.957037027634 reflect 
## 0.2251838 0.1835683 0.001980007 -432.6644 
## 0.2526659 0.1567437 0.002232313 -427.2564 
## 65 0.25266587884599 0.156743680957565 0.00223231314647738 -427.25637099341 expand 
## 0.2531461 -0.0355917 0.001601576 -Inf 
## 0.2039627 0.2582633 0.001904383 -437.7958 
## 66 0.25266587884599 0.156743680957565 0.00223231314647738 -427.25637099341 contract inside 
## 0.1826525 0.2803475 0.002323243 -429.1121 
## 67 0.25266587884599 0.156743680957565 0.00223231314647738 -427.25637099341 reflect 
## 0.2541923 0.3075551 0.002660977 -428.8869 
## 68 0.25266587884599 0.156743680957565 0.00223231314647738 -427.25637099341 reflect 
## 0.2549208 0.2313244 0.002907073 -419.9618 
## 0.2820524 0.2182829 0.003409171 -414.3369 
## 69 0.282052406939201 0.21828294984415 0.00340917129826347 -414.336868107035 expand 
## 0.3546619 0.1732018 0.003211653 -422.0146 
## 70 0.282052406939201 0.21828294984415 0.00340917129826347 -414.336868107035 reflect 
## 0.3386887 0.07873922 0.003240754 -414.0246 
## 0.3853553 -0.008053686 0.003530895 -Inf 
## 71 0.338688746549541 0.0787392241674302 0.00324075421253662 -414.024637247238 reflect 
## 0.4048307 0.1507832 0.00434428 -412.8574 
## 0.4956725 0.147826 0.005403605 -415.494 
## 72 0.404830734912483 0.150783210328962 0.00434428012212779 -412.8573852705 reflect 
## 0.3256257 0.1208614 0.004117757 -403.5389 
## 0.3115694 0.09640422 0.004571424 -396.1118 
## 73 0.311569365595007 0.0964042162565327 0.00457142373737858 -396.111757946496 expand 
## 0.4268381 0.01570083 0.004695285 -412.1072 
## 74 0.311569365595007 0.0964042162565327 0.00457142373737858 -396.111757946496 reflect 
## 0.4223054 0.09084919 0.00583655 -397.2747 
## 75 0.311569365595007 0.0964042162565327 0.00457142373737858 -396.111757946496 reflect 
## 0.3653302 -0.006537744 0.005724862 -Inf 
## 0.3947429 0.1069597 0.00468907 -404.7438 
## 76 0.311569365595007 0.0964042162565327 0.00457142373737858 -396.111757946496 contract inside 
## 0.3259883 0.1948842 0.005368989 -396.9446 
## 77 0.311569365595007 0.0964042162565327 0.00457142373737858 -396.111757946496 reflect 
## 0.3109405 0.1444898 0.005829009 -387.9151 
## 0.2727056 0.1642255 0.006399948 -381.5289 
## 78 0.272705567313854 0.164225540011515 0.00639994839209517 -381.528893495763 expand 
## 0.2022104 0.2167047 0.005056213 -390.6954 
## 79 0.272705567313854 0.164225540011515 0.00639994839209517 -381.528893495763 reflect 
## 0.2012084 0.1214511 0.005314879 -383.5995 
## 80 0.272705567313854 0.164225540011515 0.00639994839209517 -381.528893495763 reflect 
## 0.1482324 0.245407 0.006610664 -380.6411 
## 0.08092559 0.3362029 0.007633392 -389.2785 
## 81 0.148232403655629 0.245407030719452 0.00661066371461449 -380.641095125057 reflect 
## 0.2082891 0.1357148 0.007162345 -371.2853 
## 0.2113515 0.09913294 0.008218725 -364.0568 
## 82 0.211351526119802 0.0991329350301361 0.00821872475078785 -364.056767304175 expand 
## 0.2161374 0.2154156 0.008842882 -366.9731 
## 83 0.211351526119802 0.0991329350301361 0.00821872475078785 -364.056767304175 reflect 
## 0.1193094 0.2027788 0.009384228 -366.5226 
## 84 0.211351526119802 0.0991329350301361 0.00821872475078785 -364.056767304175 reflect 
## 0.2147205 0.1033027 0.01102912 -351.9983 
## 0.2509381 0.04375503 0.01325292 -345.7852 
## 85 0.250938144969092 0.0437550266713682 0.0132529248751097 -345.785217431914 expand 
## 0.1673888 0.02378624 0.01172265 -354.1273 
## 86 0.250938144969092 0.0437550266713682 0.0132529248751097 -345.785217431914 reflect 
## 0.3141469 -0.06105733 0.01274209 -Inf 
## 0.162394 0.1238317 0.0102216 -356.1544 
## 87 0.250938144969092 0.0437550266713682 0.0132529248751097 -345.785217431914 contract inside 
## 0.1736907 0.02743491 0.01526759 -342.2894 
## 0.1557249 -0.005017173 0.01882911 -Inf 
## 88 0.173690661313545 0.0274349091784117 0.0152675908070862 -342.289376101322 reflect 
## 0.2319461 -0.04666501 0.01662324 -Inf 
## 0.1790352 0.07573493 0.01181444 -348.8002 
## 89 0.173690661313545 0.0274349091784117 0.0152675908070862 -342.289376101322 contract inside 
## 0.2349283 0.07463381 0.01516922 -339.2833 
## 0.2717161 0.1019999 0.01690133 -337.9444 
## 90 0.271716081760442 0.10199988571517 0.0169013281541166 -337.944410736074 expand 
## 0.2869729 0.03847735 0.01848431 -334.8466 
## 0.3487083 0.02079989 0.02185233 -334.4284 
## 91 0.34870825710602 0.0207998851452836 0.0218523307362906 -334.428425433325 expand 
## 0.2704302 0.0539304 0.02279054 -325.7758 
## 0.2804058 0.05909285 0.027627 -319.7901 
## 92 0.280405776847645 0.0590928530310796 0.0276270035959182 -319.790076566963 expand 
## 0.4552203 0.09383435 0.02904141 -336.4114 
## 93 0.280405776847645 0.0590928530310796 0.0276270035959182 -319.790076566963 reflect 
## 0.4561336 0.01565341 0.03559725 -327.1413 
## 94 0.280405776847645 0.0590928530310796 0.0276270035959182 -319.790076566963 reflect 
## 0.2728789 -0.02413206 0.02761561 -Inf 
## 0.4049067 0.06174739 0.02868459 -328.913 
## 95 0.280405776847645 0.0590928530310796 0.0276270035959182 -319.790076566963 contract inside 
## 0.4053256 0.07051112 0.03954795 -319.5462 
## 0.435455 0.09722769 0.0486276 -319.5858 
## 96 0.405325580546167 0.0705111226703618 0.0395479511662094 -319.546169738907 reflect 
## 0.3493518 0.03436869 0.03984278 -313.0495 
## 0.32319 0.02120209 0.04551315 -308.1459 
## 97 0.323190030125687 0.0212020932163502 0.045513146660095 -308.145927382654 expand 
## 0.2313194 0.0864103 0.03942835 -307.9929 
## 0.1430788 0.1256192 0.04135455 -309.9578 
## 98 0.231319436646312 0.0864102950999665 0.0394283508204785 -307.992933704506 reflect 
## 0.3538376 0.05818055 0.05572957 -305.5592 
## 0.3938053 0.05772499 0.07036524 -304.4006 
## 99 0.393805264511422 0.0577249944414812 0.0703652424545063 -304.400604986322 expand 
## 0.231549 0.03883428 0.06393463 -296.7854 
## 0.1598387 0.02368861 0.07656213 -298.5473 
## 100 0.231549024788303 0.0388342833863636 0.0639346343226801 -296.785418283521 reflect 
## 0.2417642 0.1032266 0.07025665 -297.2798 
## 101 0.231549024788303 0.0388342833863636 0.0639346343226801 -296.785418283521 reflect 
## 0.3434283 0.04618484 0.09856122 -295.2613 
## 0.4075034 0.02716885 0.1307246 -296.4235 
## 102 0.343428345668511 0.0461848425219775 0.0985612224372998 -295.261347456885 reflect 
## 0.1668928 0.06627572 0.08447839 -294.8659 
## 0.07905718 0.07060314 0.09167545 -310.7013 
## 103 0.166892803024763 0.0662757196110087 0.0844783865147911 -294.865855797648 reflect 
## 0.2444335 0.002226928 0.09428489 -294.4635 
## 0.2457725 -0.0416416 0.1067082 -Inf 
## 104 0.244433532937621 0.00222692772654105 0.094284892911804 -294.463461295488 reflect 
## 0.2637526 0.03623391 0.1224507 -290.0448 
## 0.2804944 0.03493859 0.1541908 -289.7661 
## 105 0.280494384438864 0.0349385941053091 0.15419076997237 -289.766060764887 expand 
## 0.132112 0.02174157 0.1219763 -299.6589 
## 0.2835333 0.03996503 0.1043229 -291.5527 
## 106 0.280494384438864 0.0349385941053091 0.15419076997237 -289.766060764887 contract inside 
## 0.3912578 -0.01239387 0.1515205 -Inf 
## 0.2159148 0.04545628 0.1004962 -291.2747 
## 107 0.280494384438864 0.0349385941053091 0.15419076997237 -289.766060764887 contract inside 
## 0.2743116 0.08095268 0.145158 -291.9052 
## 0.2667084 0.06013408 0.1320014 -290.6005 
## 108 0.280494384438864 0.0349385941053091 0.15419076997237 -289.766060764887 contract outside 
## 0.225317 0.05360624 0.153685 -289.9651 
## 109 0.280494384438864 0.0349385941053091 0.15419076997237 -289.766060764887 reflect 
## 0.3010981 0.05347527 0.196587 -291.6289 
## 0.2361475 0.04744956 0.1230425 -290.0107 
## 110 0.280494384438864 0.0349385941053091 0.15419076997237 -289.766060764887 contract inside 
## 0.2276394 0.03082395 0.1551371 -289.7749 
## 111 0.280494384438864 0.0349385941053091 0.15419076997237 -289.766060764887 reflect 
## 0.2518906 0.03205567 0.1874262 -289.8325 
## 112 0.280494384438864 0.0349385941053091 0.15419076997237 -289.766060764887 reflect 
## 0.2818994 0.01242115 0.1773183 -289.7324 
## 0.3121966 -0.006987103 0.1895018 -Inf 
## 113 0.281899420313827 0.0124211532936626 0.177318292447169 -289.732438739597 reflect 
## 0.2739671 0.01995028 0.1378656 -289.7702 
## 114 0.281899420313827 0.0124211532936626 0.177318292447169 -289.732438739597 reflect 
## 0.3343614 0.01401678 0.1573296 -290.9973 
## 0.2526868 0.02657014 0.1556844 -289.4538 
## 115 0.252686821553723 0.026570143739125 0.15568442533636 -289.453837168498 contract inside 
## 0.2691424 0.02920911 0.1878118 -289.7913 
## 0.2727575 0.02224934 0.1499542 -289.5476 
## 116 0.252686821553723 0.026570143739125 0.15568442533636 -289.453837168498 contract inside 
## 0.2577039 0.006223583 0.1676204 -290.0942 
## 0.2747197 0.02760728 0.1575191 -289.5399 
## 117 0.252686821553723 0.026570143739125 0.15568442533636 -289.453837168498 contract inside 
## 0.2517448 0.03886028 0.1323125 -289.6921 
## 0.2591496 0.03212188 0.1432382 -289.5105 
## 118 0.252686821553723 0.026570143739125 0.15568442533636 -289.453837168498 contract outside 
## 0.2516546 0.03535574 0.1542784 -289.4773 
## 119 0.252686821553723 0.026570143739125 0.15568442533636 -289.453837168498 reflect 
## 0.234889 0.03509284 0.144633 -289.5993 
## 0.2645231 0.0294685 0.1542705 -289.4647 
## 120 0.252686821553723 0.026570143739125 0.15568442533636 -289.453837168498 contract inside 
## 0.2533858 0.02878721 0.1664838 -289.4974 
## 0.2548218 0.02961886 0.1605842 -289.4548 
## 121 0.252686821553723 0.026570143739125 0.15568442533636 -289.453837168498 contract outside 
## 0.2630427 0.0218343 0.1594131 -289.4721 
## 0.2601763 0.02518144 0.1581252 -289.4456 
## 122 0.260176265263622 0.0251814439701574 0.158125172564548 -289.44555761184 contract outside 
## 0.2473683 0.02478247 0.162011 -289.5346 
## 0.2601903 0.02829298 0.1561959 -289.4404 
## 123 0.260190269906473 0.0282929811375824 0.156195931269578 -289.440409718748 contract inside 
## 0.2605402 0.02375776 0.1527772 -289.462 
## 0.2562465 0.0281473 0.1586226 -289.4429 
## 124 0.260190269906473 0.0282929811375824 0.156195931269578 -289.440409718748 contract inside 
## 0.2651111 0.02784112 0.1596161 -289.4606 
## 0.2557699 0.02688759 0.1566649 -289.4422 
## 125 0.260190269906473 0.0282929811375824 0.156195931269578 -289.440409718748 contract inside 
## 0.2546342 0.03038286 0.1561968 -289.4432 
## 0.2560152 0.02907756 0.1566783 -289.4396 
## 126 0.256015156463406 0.0290775639492081 0.15667826873565 -289.43958905626 contract outside 
## 0.258399 0.0280232 0.154411 -289.4379 
## 0.259478 0.02796116 0.1523167 -289.4429 
## 127 0.258399010625601 0.028023201298938 0.154411036636231 -289.43787005344 reflect 
## 0.2606378 0.03004603 0.1548584 -289.4484 
## 0.2569834 0.02767539 0.1562127 -289.4381 
## 128 0.258399010625601 0.028023201298938 0.154411036636231 -289.43787005344 contract inside 
## 0.254088 0.02822376 0.1553374 -289.4416 
## 0.2586592 0.02827568 0.1559812 -289.438 
## 129 0.258399010625601 0.028023201298938 0.154411036636231 -289.43787005344 contract inside 
## 0.260018 0.02690745 0.1543928 -289.4406 
## 0.2570135 0.02853418 0.1561061 -289.4378 
## 130 0.257013491991301 0.0285341762295787 0.15610606244444 -289.437768346937 contract inside 
## 0.2590653 0.02888061 0.154786 -289.4395 
## 0.2575032 0.02797643 0.1558557 -289.4374 
## 131 0.257503208697247 0.0279764257052071 0.155855701519683 -289.437375426902 contract inside 
## 0.2566191 0.02808009 0.1549335 -289.4375 
## 132 0.257503208697247 0.0279764257052071 0.155855701519683 -289.437375426902 reflect 
## 0.2556942 0.02837054 0.1568546 -289.4398 
## 0.2577217 0.02811001 0.155021 -289.4372 
## 133 0.25772172557642 0.0281100130006698 0.155020967771753 -289.43723012192 contract inside 
## 0.257549 0.02757728 0.154435 -289.4379 
## 0.2571473 0.02829479 0.1556878 -289.4373 
## 134 0.25772172557642 0.0281100130006698 0.155020967771753 -289.43723012192 contract inside 
## 0.2582967 0.02817403 0.1561099 -289.4377 
## 0.2570381 0.02810357 0.1552274 -289.4373 
## 135 0.25772172557642 0.0281100130006698 0.155020967771753 -289.43723012192 contract inside 
## 0.2571015 0.02836255 0.1547688 -289.4372 
## 136 0.25772172557642 0.0281100130006698 0.155020967771753 -289.43723012192 reflect 
## 0.2574268 0.02808929 0.1543243 -289.4375 
## 0.2572172 0.0282434 0.1553467 -289.4372 
## 137 0.257217168354136 0.0282434046366326 0.155346661988581 -289.437209277334 contract inside 
## 0.2576555 0.02837375 0.1548635 -289.4373 
## 0.2571924 0.0281711 0.1551364 -289.4372 
## 138 0.257192400547708 0.0281711035767603 0.15513639913756 -289.437196403905 contract inside 
## 0.2576527 0.0279872 0.1555675 -289.4373 
## 0.2572392 0.02826868 0.1549684 -289.4372 
## 139 0.257239249380636 0.0282686827112051 0.154968363305247 -289.437188161234 contract inside 
## 0.2567112 0.02834547 0.15528 -289.4373 
## 0.2574689 0.02816887 0.1550857 -289.4372 
## 140 0.257468948229913 0.0281688674536586 0.155085707295487 -289.437182876523 contract inside 
## 0.2573832 0.02816236 0.1547804 -289.4372 
## 0.2572587 0.02822314 0.1552051 -289.4372 
## 141 0.257468948229913 0.0281688674536586 0.155085707295487 -289.437182876523 contract inside 
## 0.2574522 0.02826936 0.1550363 -289.4372 
## 0.2573872 0.02824479 0.1550614 -289.4372 
## 142 0.257387234037763 0.0282447942040666 0.155061353457504 -289.437180341726 contract outside 
## 0.257504 0.02815586 0.1552664 -289.4372 
## 0.2574378 0.02818406 0.1551919 -289.4372 
## 143 0.257437806305325 0.0281840618847959 0.155191886248741 -289.437179241813 contract outside 
## 0.257604 0.02817534 0.1550209 -289.4372 
## 0.257345 0.02821119 0.155159 -289.4372 
## 144 0.257344996730564 0.0282111915064129 0.155159016168335 -289.437177963882 contract inside 
## 0.2573111 0.02825783 0.1551891 -289.4372 
## 0.2573505 0.02823559 0.1551633 -289.4372 
## 145 0.257344996730564 0.0282111915064129 0.155159016168335 -289.437177963882 contract outside 
## 0.2573683 0.02817577 0.1552815 -289.4372 
## 0.2573825 0.02822754 0.1551164 -289.4372 
## 146 0.25738250785891 0.0282275372645392 0.155116369757988 -289.437177705871 contract inside 
## 0.2572809 0.02826549 0.1551006 -289.4372 
## 0.2573986 0.02820442 0.1551691 -289.4372 
## 147 0.25738250785891 0.0282275372645392 0.155116369757988 -289.437177705871 contract inside 
## 0.2574002 0.02819317 0.155133 -289.4372 
## 148 0.25738250785891 0.0282275372645392 0.155116369757988 -289.437177705871 reflect 
## 0.2574425 0.02820556 0.1551199 -289.4372 
## 0.2573694 0.02820978 0.1551492 -289.4372 
## 149 0.257369374476693 0.0282097836982188 0.15514924802541 -289.437177414844 contract inside 
## 0.2573695 0.02821591 0.1550967 -289.4372 
## 150 0.257369374476693 0.0282097836982188 0.15514924802541 -289.437177414844 reflect 
## 0.2573474 0.02824232 0.1551085 -289.4372 
## 0.257387 0.02820546 0.1551269 -289.4372 
## 151 0.257369374476693 0.0282097836982188 0.15514924802541 -289.437177414844 contract inside 
## 0.2573898 0.02821261 0.155165 -289.4372 
## 0.2573847 0.02821343 0.1551479 -289.4372 
## 152 0.257369374476693 0.0282097836982188 0.15514924802541 -289.437177414844 contract outside 
## 0.2573782 0.02819158 0.1551663 -289.4372 
## 0.2573814 0.02821855 0.1551289 -289.4372 
## 153 0.257381429204498 0.0282185479411412 0.155128859556382 -289.437177390798 contract inside 
## 0.25737 0.02822238 0.1551571 -289.4372 
## 0.2573827 0.02820969 0.1551345 -289.4372 
## 154 0.257382739415651 0.0282096903803931 0.15513445041233 -289.437177340208 contract inside 
## 0.257371 0.02821191 0.1551271 -289.4372 
## 0.2573641 0.02821115 0.1551168 -289.4372 
## 155 0.257370995928684 0.0282119143870071 0.155127134746347 -289.437177313463 reflect 
## 0.2573874 0.02821698 0.155111 -289.4372 
## 0.2573739 0.02821158 0.1551397 -289.4372 
## 156 0.257373881302686 0.0282115839571637 0.155139698048709 -289.437177312644 contract inside 
## 0.2573703 0.02820358 0.1551387 -289.4372 
## 0.2573787 0.02821481 0.1551313 -289.4372 
## 157 0.257373881302686 0.0282115839571637 0.155139698048709 -289.437177312644 contract inside 
## 0.2573663 0.02821585 0.155131 -289.4372 
## 0.257358 0.02821892 0.1551292 -289.4372 
## 158 0.257366279293166 0.0282158454704545 0.155130978273051 -289.437177295431 reflect 
## 0.2573621 0.02821142 0.1551339 -289.4372 
## 0.2573745 0.02821396 0.155132 -289.4372 
## 159 0.257366279293166 0.0282158454704545 0.155130978273051 -289.437177295431 contract inside 
## 0.2573721 0.02821568 0.1551413 -289.4372 
## 0.2573713 0.02821286 0.1551307 -289.4372 
## 160 0.257366279293166 0.0282158454704545 0.155130978273051 -289.437177295431 contract inside 
## 0.2573675 0.02821686 0.1551227 -289.4372 
## 0.2573723 0.0282129 0.1551355 -289.4372 
## 161 0.257366279293166 0.0282158454704545 0.155130978273051 -289.437177295431 contract inside 
## 0.2573654 0.02821378 0.1551328 -289.4372 
## 0.2573722 0.02821391 0.1551322 -289.4372 
## 162 0.257372232956427 0.0282139138395695 0.155132162079381 -289.437177292996 contract inside 
## 0.2573693 0.02821559 0.1551351 -289.4372 
## 163 0.257372232956427 0.0282139138395695 0.155132162079381 -289.437177292996 reflect 
## 0.2573662 0.02821733 0.15513 -289.4372 
## 0.2573708 0.02821401 0.1551341 -289.4372 
## 164 0.257370771077467 0.0282140085351405 0.155134090947354 -289.437177292653 contract inside 
## 0.2573703 0.02821359 0.1551298 -289.4372 
## 0.25737 0.02821409 0.1551311 -289.4372 
## 165 0.257370014281873 0.0282140911577371 0.155131088530639 -289.437177292564 contract outside 
## 0.2573757 0.02821216 0.1551339 -289.4372 
## 0.2573686 0.02821492 0.1551317 -289.4372 
## 166 0.257368642694431 0.0282149249898085 0.155131712728286 -289.437177292014 contract inside 
## 0.2573674 0.02821477 0.1551324 -289.4372 
## 0.257371 0.02821413 0.1551322 -289.4372 
## 167 0.257371021152366 0.0282141277001046 0.155132229740009 -289.437177291819 contract inside 
## 0.257369 0.02821475 0.1551293 -289.4372 
## 0.2573703 0.02821419 0.1551329 -289.4372 
## 168 0.257370331892981 0.0282141949087395 0.155132883972144 -289.437177291692 contract inside 
## 0.25737 0.02821474 0.1551335 -289.4372 
## 169 0.257370331892981 0.0282141949087395 0.155132883972144 -289.437177291692 reflect 
## 0.2573722 0.02821378 0.155134 -289.4372 
## 0.2573695 0.02821464 0.1551323 -289.4372 
## 170 0.257369544000118 0.0282146396920374 0.155132285721057 -289.437177291521 contract inside 
## 0.2573706 0.0282139 0.1551315 -289.4372 
## 0.2573701 0.02821453 0.155133 -289.4372 
## 171 0.257369544000118 0.0282146396920374 0.155132285721057 -289.437177291521 contract inside 
## 0.257369 0.02821478 0.1551332 -289.4372 
## 0.2573705 0.02821429 0.1551325 -289.4372 
## 172 0.257369544000118 0.0282146396920374 0.155132285721057 -289.437177291521 contract inside 
## 0.2573698 0.02821478 0.1551323 -289.4372 
## 0.2573695 0.02821507 0.155132 -289.4372 
## 173 0.257369800325618 0.0282147795967426 0.155132263185689 -289.437177291396 reflect 
## 0.2573698 0.02821461 0.1551317 -289.4372 
## 0.2573699 0.02821459 0.155132 -289.4372 
## 174 0.257369800325618 0.0282147795967426 0.155132263185689 -289.437177291396 contract outside 
## 0.257369 0.02821505 0.1551319 -289.4372 
## 0.2573701 0.02821448 0.1551323 -289.4372 
## 175 0.257369800325618 0.0282147795967426 0.155132263185689 -289.437177291396 contract inside 
## 0.2573703 0.02821459 0.1551321 -289.4372 
## 176 0.257369800325618 0.0282147795967426 0.155132263185689 -289.437177291396 reflect 
## 0.2573703 0.02821465 0.1551325 -289.4372 
## 177 0.257369800325618 0.0282147795967426 0.155132263185689 -289.437177291396 reflect 
## 0.2573701 0.02821487 0.1551322 -289.4372 
## 178 0.257369800325618 0.0282147795967426 0.155132263185689 -289.437177291396 reflect 
## 0.2573699 0.02821493 0.1551325 -289.4372 
## 0.2573702 0.02821468 0.1551322 -289.4372 
## 179 0.257370196845938 0.0282146787450719 0.1551322230418 -289.437177291383 contract inside 
## 0.25737 0.02821454 0.1551324 -289.4372 
## 0.2573701 0.02821478 0.1551323 -289.4372 
## 180 0.257370123927234 0.028214783530546 0.155132273499125 -289.43717729138 contract inside 
## 0.2573698 0.02821485 0.1551321 -289.4372 
## 0.2573702 0.0282147 0.1551324 -289.4372 
## 181 0.257370123927234 0.028214783530546 0.155132273499125 -289.43717729138 contract inside 
## 0.2573705 0.02821466 0.1551323 -289.4372 
## 0.25737 0.02821475 0.1551323 -289.4372 
## 182 0.257369981854014 0.0282147496146796 0.155132273355877 -289.437177291377 contract inside 
## 0.25737 0.02821481 0.1551324 -289.4372 
## 0.2573701 0.02821471 0.1551323 -289.4372 
## 183 0.257369981854014 0.0282147496146796 0.155132273355877 -289.437177291377 contract inside 
## 0.25737 0.0282148 0.1551322 -289.4372 
## 184 0.257369981854014 0.0282147496146796 0.155132273355877 -289.437177291377 reflect 
## 0.25737 0.02821472 0.1551322 -289.4372 
## 0.25737 0.02821474 0.1551322 -289.4372 
## 185 0.25736999977187 0.0282147382797256 0.155132223252751 -289.437177291376 contract outside 
## Optimization has terminated successfully.</code></pre>
<p>This vignette runs the analysis itself. You will see all the loglik
values that are tried out during the optimization.That is what you
normally see in your console when running an analysis. I will now show
what the output is like.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>output_vig<span class="sc">$</span>model_ml</span></code></pre></div>
<pre><code>## [1] -289.4372</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>output_vig<span class="sc">$</span>number_free_pars</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>With the information from “output model_ml” and “output
number_free_pars” we can compare across models using AIC. We can see the
rates of the model, those are the rates that maximize the
likelihood.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>output_vig<span class="sc">$</span>estimated_rates</span></code></pre></div>
<pre><code>##          in-situ       vicariance    disper-extirp Fixed_extinction 
##       0.25737000       0.02821474       0.15513222       0.00100000</code></pre>
<p>In-situ speciation is estimated to be higher than vicariance. And,
extinction is fixed at 0.001 as we set it up. output$ancestral_states
will provide the probability of each ancestor (internal node) being at
each region (or combination of regions), here is the first lines of such
an object:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(output_vig<span class="sc">$</span>ancestral_states)</span></code></pre></div>
<pre><code>##            A         B         C         AB         AC         BC        ABC
## 67 0.2681845 0.2841608 0.2956525 0.03027358 0.03091100 0.03178615 0.05903146
## 68 0.2629808 0.2637889 0.2620855 0.02887410 0.02878072 0.02882493 0.12466507
## 69 0.2615897 0.2742949 0.2487303 0.02936550 0.02796358 0.02863461 0.12942139
## 70 0.2569954 0.2764418 0.2934955 0.02923700 0.03032817 0.03134435 0.08215770
## 71 0.2694334 0.2701941 0.2530013 0.02957933 0.02862706 0.02867076 0.12049407
## 72 0.2752458 0.2808611 0.2335341 0.03048075 0.02786939 0.02815764 0.12385125</code></pre>
<p>Those are the probabilities for the internal nodes 67, 68 up to 72.
Now, one can use a function to plot those values into our phylogenetic
tree (function not provided in LEMAD yet, but soon ).</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
